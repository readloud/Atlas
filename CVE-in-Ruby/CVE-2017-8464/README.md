# CVE-2017-8464 | LNK Remote Code Execution Vulnerability
A remote code execution vulnerability exists in Microsoft Windows that could allow remote code execution if a .LNK file is processed.An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The attacker could present to the user a removable drive, or remote share, that contains a malicious .LNK file and an associated malicious binary. When the user opens this drive(or remote share) in Windows Explorer, or any other application that parses the .LNK file, the malicious binary will execute code of the attackerâ€™s choice, on the target system.The security update addresses the vulnerability by correcting the processing of shortcut LNK references.

# Usage
**Exploit**

- run the exploit

Node: the .dll file is a shell, could be a meterpreter shell.

```
ruby cve-2017-8464_exploit.rb  </path/to/test.lnk> </path/to/test.dll>
```

- Copy the generate .lnk file to your Share or USB drive. 

## PoC

```
-> ruby cve-0000-0000_exploit.rb  </path/to/test.lnk> </path/to/test.dll
```

# References
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8464
- https://msdn.microsoft.com/en-us/library/dd871305.aspx
- https://winprotocoldoc.blob.core.windows.net/productionwindowsarchives/MS-SHLLINK/[MS-SHLLINK]-160714.pdf
- https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf
- https://support.microsoft.com/en-us/help/149648/description-of-control-panel--cpl-files
- https://twitter.com/mkolsek/status/877499744704237568
- https://community.saas.hpe.com/t5/Security-Research/Full-details-on-CVE-2015-0096-and-the-failed-MS10-046-Stuxnet/ba-p/251257#.WXi4uNPys6g
- https://github.com/rapid7/metasploit-framework/pull/8767
- http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8464

